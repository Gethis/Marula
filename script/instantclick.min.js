var InstantClick=function(e,t){function a(e){var t=e.indexOf("#");return 0>t?e:e.substr(0,t)}function n(e){for(;"A"!=e.nodeName;)e=e.parentNode;return e}function r(e){do{if(!e.hasAttribute)break;if(e.hasAttribute("data-instant"))return!1;if(e.hasAttribute("data-no-instant"))return!0}while(e=e.parentNode);return!1}function o(e){do{if(!e.hasAttribute)break;if(e.hasAttribute("data-no-instant"))return!1;if(e.hasAttribute("data-instant"))return!0}while(e=e.parentNode);return!1}function i(e,t){for(var a=0;a<D[e].length;a++)D[e][a](t)}function s(t,n,r,o){if(e.title=t,e.documentElement.replaceChild(n,e.body),r){history.pushState(null,null,r);var s=r.indexOf("#"),l=s>-1&&e.getElementById(r.substr(s+1)),u=0;if(l)for(;l.offsetParent;)u+=l.offsetTop,l=l.offsetParent;scrollTo(0,u),b=a(r)}else scrollTo(0,o);g(),R.done(),i("change",!1)}function l(){O=!1,M=!1}function u(e){m(n(e.target).href)}function d(e){var t=n(e.target);t.addEventListener("mouseout",h),k?(x=t.href,S=setTimeout(m,k)):m(t.href)}function c(e){var t=n(e.target);I?t.removeEventListener("mousedown",u):t.removeEventListener("mouseover",d),m(t.href)}function p(e){e.which>1||e.metaKey||e.ctrlKey||(e.preventDefault(),v(n(e.target).href))}function h(){return S?(clearTimeout(S),S=!1,void 0):(O&&!M&&(w.abort(),l()),void 0)}function f(){if(!(w.readyState<4)&&0!=w.status){if(B.ready=+new Date-B.start,i("receive"),w.getResponseHeader("Content-Type").match(/\/(x|ht|xht)ml/)){var t=e.implementation.createHTMLDocument("");t.documentElement.innerHTML=w.responseText,H=t.title,L=t.body;var n=a(E);C[n]={body:L,title:H,scrollY:n in C?C[n].scrollY:0};for(var r,o,s=t.head.children,l=0,u=s.length-1;u>=0;u--)if(r=s[u],r.hasAttribute("data-instant-track")){o=r.getAttribute("href")||r.getAttribute("src")||r.innerHTML;for(var d=P.length-1;d>=0;d--)P[d]==o&&l++}l!=P.length&&(U=!0)}else U=!0;M&&(M=!1,v(E))}}function g(n){for(var i,s=e.getElementsByTagName("a"),l=t.protocol+"//"+t.host,h=s.length-1;h>=0;h--)i=s[h],i.target||i.hasAttribute("download")||0!=i.href.indexOf(l+"/")||i.href.indexOf("#")>-1&&a(i.href)==b||(T?!o(i):r(i))||(i.addEventListener("touchstart",c),I?i.addEventListener("mousedown",u):i.addEventListener("mouseover",d),i.addEventListener("click",p));if(!n){var f,g,m,v,y=e.body.getElementsByTagName("script");for(h=0,j=y.length;j>h;h++)f=y[h],f.hasAttribute("data-no-instant")||(g=e.createElement("script"),f.src&&(g.src=f.src),f.innerHTML&&(g.innerHTML=f.innerHTML),m=f.parentNode,v=f.nextSibling,m.removeChild(f),m.insertBefore(g,v))}}function m(e){!I&&"display"in B&&+new Date-(B.start+B.display)<100||(S&&(clearTimeout(S),S=!1),e||(e=x),(!O||e!=E&&!M)&&(O=!0,M=!1,E=e,L=!1,U=!1,B={start:+new Date},i("fetch"),w.open("GET",e),w.send()))}function v(e){return"display"in B||(B.display=+new Date-B.start),S?E&&E!=e?(t.href=e,void 0):(m(e),R.start(0,!0),i("wait"),M=!0,void 0):!O||M?(t.href=e,void 0):U?(t.href=E,void 0):L?(C[b].scrollY=pageYOffset,l(),s(H,L,E),void 0):(R.start(0,!0),i("wait"),M=!0,void 0)}function y(){if(!b){if(!z)return i("change",!0),void 0;for(var n=arguments.length-1;n>=0;n--){var r=arguments[n];r===!0?T=!0:"mousedown"==r?I=!0:"number"==typeof r&&(k=r)}b=a(t.href),C[b]={body:e.body,title:e.title,scrollY:pageYOffset};for(var o,l,u=e.head.children,n=u.length-1;n>=0;n--)o=u[n],o.hasAttribute("data-instant-track")&&(l=o.getAttribute("href")||o.getAttribute("src")||o.innerHTML,P.push(l));w=new XMLHttpRequest,w.addEventListener("readystatechange",f),g(!0),R.init(),i("change",!0),addEventListener("popstate",function(){var e=a(t.href);if(e!=b){if(!(e in C))return t.href=t.href,void 0;C[b].scrollY=pageYOffset,b=e,s(C[e].title,C[e].body,!1,C[e].scrollY)}})}}function $(e,t){D[e].push(t)}var b,x,S,w,T,I,k,_=navigator.userAgent,A="createTouch"in e,C={},E=!1,H=!1,U=!1,L=!1,B={},O=!1,M=!1,P=[],D={fetch:[],receive:[],wait:[],change:[]},R=function(){function t(){l=e.createElement("div"),l.id="instantclick",u=e.createElement("div"),u.id="instantclick-bar",u.className="instantclick-bar",l.appendChild(u);var t=["Webkit","Moz","O"];if(d="transform",!(d in u.style))for(var a=0;3>a;a++)t[a]+"Transform"in u.style&&(d=t[a]+"Transform");var n="transition";if(!(n in u.style))for(var a=0;3>a;a++)t[a]+"Transition"in u.style&&(n="-"+t[a].toLowerCase()+"-"+n);var r=e.createElement("style");r.innerHTML="#instantclick{position:"+(A?"absolute":"fixed")+";top:0;left:0;width:100%;pointer-events:none;z-index:2147483647;"+n+":opacity .25s .1s}"+".instantclick-bar{background:#29d;width:100%;margin-left:-100%;height:2px;"+n+":all .25s}",e.head.appendChild(r),A&&(s(),addEventListener("resize",s),addEventListener("scroll",s))}function a(t,a){c=t,e.getElementById(l.id)&&e.body.removeChild(l),l.style.opacity="1",e.getElementById(l.id)&&e.body.removeChild(l),o(),a&&setTimeout(n,0),clearTimeout(p),p=setTimeout(r,500)}function n(){c=10,o()}function r(){c+=1+2*Math.random(),c>=98?c=98:p=setTimeout(r,500),o()}function o(){u.style[d]="translate("+c+"%)",e.getElementById(l.id)||e.body.appendChild(l)}function i(){return e.getElementById(l.id)?(clearTimeout(p),c=100,o(),l.style.opacity="0",void 0):(a(100==c?0:c),setTimeout(i,0),void 0)}function s(){l.style.left=pageXOffset+"px",l.style.width=innerWidth+"px",l.style.top=pageYOffset+"px";var e=2*(innerWidth/screen[90==Math.abs(orientation)?"height":"width"]);l.style[d]="scaleY("+e+")"}var l,u,d,c,p;return{init:t,start:a,done:i}}(),z="pushState"in history&&(!_.match("Android")||_.match("Chrome/"))&&"file:"!=t.protocol;return{supported:z,init:y,on:$}}(document,location);